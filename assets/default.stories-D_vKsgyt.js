import{p as g,c as y,n as P,a as A,C as c,P as x,F as l}from"./create-game-DQQ4oOcD.js";import"./_commonjsHelpers-Cpj98o6Y.js";const C={alpha:.5,strokeColor:1920728,strokeAlpha:.3,strokeWidth:5,radius:16,fillColor:2450411},E={alpha:.05,strokeColor:1920728,strokeAlpha:.3,strokeWidth:5,radius:64,fillColor:2450411},I={alpha:1,strokeColor:1920728,strokeAlpha:.4,strokeWidth:5,radius:40,fillColor:1920728},a={MOVE_FACTOR:.03,SCREEN_PADDING:24,MAX_DISTANCE_FACTOR:.9,DISTANCE_THRESHOLD_MULTIPLIER:2.1,DEFAULT_TOP_PADDING:.2,DEFAULT_LEFT_HALF:.5,HIDDEN_POSITION:-100,HIDDEN_ALPHA:0,VISIBLE_ALPHA:1},D=o=>{const t=o.scale.width,e=o.scale.height;return{topLeft:{x:0,y:e*a.DEFAULT_TOP_PADDING},bottomRight:{x:t*a.DEFAULT_LEFT_HALF,y:e}}},S=(o,t,e)=>o>=e.topLeft.x&&o<=e.bottomRight.x&&t>=e.topLeft.y&&t<=e.bottomRight.y;var h;(function(o){o.UPDATE="touchpad-joystick-update",o.RELEASE="touchpad-joystick-release",o.PRESS="touchpad-joystick-press"})(h||(h={}));const d=(o,t)=>`${o}${t}`.replace(/[^a-zA-Z0-9]/g,""),k=36,T=()=>{const o=performance.now().toString(k),t=Math.random().toString(k).substring(2);return`${o}${t}`.replace(/[^a-zA-Z0-9]/g,"")};class v extends g.GameObjects.Container{deadZone;baseArea;stick;stickIcon;analogContainer;startPosition;buttonsContainer;touchId=null;deadZoneConfig;baseAreaConfig;stickConfig;bounds;id;constructor({scene:t,deadZone:e,baseArea:s,stick:i,stickIcon:n,bounds:r,enableWithoutTouch:u=!1,id:p}){super(t,0,0),this.deadZoneConfig={...C,...e??{}},this.baseAreaConfig={...E,...s??{}},this.stickConfig={...I,...i??{}},this.id=p??T(),this.bounds=r??D(t),!(!this.scene.sys.game.device.input.touch&&!u)&&(this.setScrollFactor(0),this.createJoystick(n),this.setupEventListeners())}createJoystick(t){this.analogContainer=this.scene.add.container(a.HIDDEN_POSITION,a.HIDDEN_POSITION),this.add(this.analogContainer);const{deadZoneConfig:e,baseAreaConfig:s,stickConfig:i}=this;this.deadZone=this.scene.add.circle(0,0,e.radius,e.fillColor,e.alpha),this.deadZone.setOrigin(.5,.5).setStrokeStyle(e.strokeWidth,e.strokeColor,e.strokeAlpha),this.analogContainer.add(this.deadZone),this.baseArea=this.scene.add.circle(0,0,s.radius,s.fillColor,s.alpha),this.baseArea.setOrigin(.5,.5).setStrokeStyle(s.strokeWidth,s.strokeColor,s.strokeAlpha),this.analogContainer.add(this.baseArea),this.stick=this.scene.add.circle(0,0,i.radius,i.fillColor,i.alpha),this.stick.setOrigin(.5,.5).setStrokeStyle(i.strokeWidth,i.strokeColor,i.strokeAlpha),this.analogContainer.add(this.stick),t&&(this.stickIcon=t,this.analogContainer.add(this.stickIcon)),this.stickIcon&&(this.stickIcon.setOrigin(.5,.5),this.analogContainer.add(this.stickIcon))}resetJoystick(t){this.touchId===null||this.touchId!==t.id||this.startPosition===null||(this.analogContainer.setPosition(a.HIDDEN_POSITION,a.HIDDEN_POSITION),this.analogContainer.setAlpha(a.HIDDEN_ALPHA),this.stick.setPosition(0,0),this.stickIcon?.setPosition(0,0),this.startPosition=null,this.touchId=null)}on(t,e){if(t==="move"){const s=d(h.UPDATE,this.id);return this.scene.events.on(s,e),this}if(t==="release"){const s=d(h.RELEASE,this.id);return this.scene.events.on(s,e),this}if(t==="press"){const s=d(h.PRESS,this.id);return this.scene.events.on(s,e),this}return console.warn(`Event ${t} not supported`),this}emitMove(t,e){const s=d(h.UPDATE,this.id);this.scene.events.emit(s,{x:t,y:e})}emitRelease(){const t=d(h.RELEASE,this.id);this.scene.events.emit(t)}emitPress(){const t=d(h.PRESS,this.id);this.scene.events.emit(t)}update(){if(this.startPosition===null||!this.touchId||this.touchId!==this.scene.input.activePointer.id)return;let t=null;this.scene.input.manager.pointers&&(t=this.scene.input.manager.pointers.find(n=>n.id===this.touchId)),t??=this.scene.input.activePointer;const e=new g.Math.Vector2(t.x,t.y).subtract(this.startPosition),s=this.baseArea.radius*a.MAX_DISTANCE_FACTOR;e.length()>s*a.DISTANCE_THRESHOLD_MULTIPLIER&&this.moveJoystickToPointer(e)}moveJoystickToPointer(t){const e=a.SCREEN_PADDING;if(this.startPosition===null)return;let s=this.startPosition.x+t.x*a.MOVE_FACTOR,i=this.startPosition.y+t.y*a.MOVE_FACTOR;const n=this.bounds.topLeft.x+e+this.baseArea.radius+this.stick.radius,r=this.bounds.bottomRight.x-e-this.baseArea.radius-this.stick.radius,u=this.bounds.topLeft.y+e+this.baseArea.radius+this.stick.radius,p=this.bounds.bottomRight.y-e-this.baseArea.radius-this.stick.radius;s=Math.max(s,n),s=Math.min(s,r),i=Math.max(i,u),i=Math.min(i,p),this.startPosition.set(s,i),this.analogContainer.setPosition(s,i)}setupEventListeners(){this.scene.input.on("pointerdown",this.onPointerDown,this),this.scene.input.on("pointermove",this.onPointerMove,this),this.scene.input.on("pointerup",this.onPointerUp,this),this.scene.input.on("pointercancel",this.onPointerCancel,this)}onPointerDown(t){const{x:e,y:s}=t;this.touchId!==null||this.scene.input.hitTestPointer(t).some(r=>!r.input?.enabled||r===this||r===this.analogContainer?!1:r.parentContainer===this.buttonsContainer)||S(e,s,this.bounds)&&(this.analogContainer.setPosition(e,s),this.analogContainer.setAlpha(a.VISIBLE_ALPHA),this.stickIcon?.setPosition(0,0),this.startPosition=new g.Math.Vector2(e,s),this.touchId=t.id,this.emitPress())}onPointerMove(t){const{x:e,y:s}=t;if(this.startPosition===null||!this.touchId||this.touchId!==t.id)return;const i=new g.Math.Vector2(e,s).subtract(this.startPosition),n=this.baseArea.radius*a.MAX_DISTANCE_FACTOR,r=i.length();r>n&&i.normalize().scale(n);const u=i.x/n,p=i.y/n;this.emitMove(u,p),this.stick.setPosition(i.x,i.y),this.stickIcon?.setPosition(i.x,i.y),r>n*a.DISTANCE_THRESHOLD_MULTIPLIER&&this.moveJoystickToPointer(i)}onPointerUp(t){this.emitRelease(),this.resetJoystick(t)}onPointerCancel(t){this.emitRelease(),this.resetJoystick(t)}destroy(){this.scene.input.off("pointerdown",this.onPointerDown,this),this.scene.input.off("pointermove",this.onPointerMove,this),this.scene.input.off("pointerup",this.onPointerUp,this),this.scene.input.off("pointercancel",this.onPointerCancel,this),this.removeAll(!0),this.startPosition=null,this.touchId=null,super.destroy()}}const f="phaser-virtual-joystick-default",b=`
import { VirtualJoystick } from 'phaser-virtual-joystick';

class GameScene extends Phaser.Scene {
    create() {
        // Create a virtual joystick with default settings
        const joystick = new VirtualJoystick({
            scene: this
        });

        // Listen to joystick events
        joystick.on('move', (data) => {
            console.log(\`Joystick position: \${data.x}, \${data.y}\`);
        });

        joystick.on('press', () => {
            console.log('Joystick pressed');
        });

        joystick.on('release', () => {
            console.log('Joystick released');
        });
    }
}
`;class O extends x.Scene{joystick;positionText;eventText;character;axesPosition={x:0,y:0};constructor(){super("preview")}preload(){}create(){this.cameras.main.setBackgroundColor(c.rgb("slate-900"));const t=this.cameras.main.centerX,e=this.cameras.main.centerY;this.add.text(t,80,"Phaser Virtual Joystick",{color:c.rgb("slate-200"),align:"center",fontSize:l.px("4xl")}).setOrigin(.5,.5),this.add.text(t,140,"Touch and drag in the left half of the screen to use the joystick",{color:c.rgb("slate-300"),align:"center",fontSize:l.px("lg"),wordWrap:{width:600}}).setOrigin(.5,.5),this.positionText=this.add.text(t,e-100,"Position: (0, 0)",{color:c.rgb("slate-200"),align:"center",fontSize:l.px("2xl")}).setOrigin(.5,.5),this.eventText=this.add.text(t,e-50,"Status: Ready",{color:c.rgb("slate-300"),align:"center",fontSize:l.px("lg")}).setOrigin(.5,.5);const s=this.add.circle(t+200,e,20,5195493,1);this.character=s,s.setStrokeStyle(2,3223169),this.sys.game.device.input.touch?(this.joystick=new v({scene:this,bounds:{topLeft:{x:0,y:40},bottomRight:{x:this.cameras.main.width/2,y:this.cameras.main.height}},stickIcon:this.add.text(0,0,"ðŸŽ®",{fontSize:"24px",color:"#ffffff"}),enableWithoutTouch:!0}),this.add.existing(this.joystick),this.joystick.on("move",n=>{this.axesPosition={x:n.x,y:n.y},this.positionText&&this.positionText.setText(`Position: (${n.x.toFixed(2)}, ${n.y.toFixed(2)})`)}),this.joystick.on("press",()=>{this.axesPosition={x:0,y:0},this.eventText&&(this.eventText.setText("Status: Joystick Pressed"),this.eventText.setColor(c.rgb("green-400")))}),this.joystick.on("release",()=>{this.axesPosition={x:0,y:0},this.eventText&&(this.eventText.setText("Status: Joystick Released"),this.eventText.setColor(c.rgb("red-400")))})):this.add.text(t,e,"This demo requires a touch device to work properly",{color:c.rgb("slate-400"),align:"center",fontSize:l.px("lg"),wordWrap:{width:500}}).setOrigin(.5,.5),this.add.rectangle(this.cameras.main.width/4,this.cameras.main.height/2,this.cameras.main.width/2,this.cameras.main.height,1976635,.1).setStrokeStyle(2,4674921,.3),this.add.text(this.cameras.main.width/4,50,"Joystick Area",{color:c.rgb("slate-400"),align:"center",fontSize:l.px("sm")}).setOrigin(.5,.5),this.add.text(t+200,50,"Character (moves with joystick)",{color:c.rgb("slate-400"),align:"center",fontSize:l.px("sm")}).setOrigin(.5,.5)}update(){this.joystick?.update();const t=1.1;(this.axesPosition.x!==0||this.axesPosition.y!==0)&&this.character?.setPosition(this.character.x+this.axesPosition.x*t,this.character.y+this.axesPosition.y*t)}destroy(){this.joystick&&this.joystick.destroy()}}const L={title:"Phaser Virtual Joystick/Examples/Default",parameters:{docs:{description:{component:"Basic example showing the default behavior of the Virtual Joystick component."}}}},m={render:()=>{const o=document.createElement("div");return o.id=f,o},play:async()=>{await y(),await P(3),A(f,{type:x.AUTO,width:800,height:600,backgroundColor:c.rgb("slate-900"),parent:document.getElementById(f),scene:[O]})}};m.parameters={docs:{autoplay:!0,story:{inline:!1},source:{code:b}}};m.parameters={...m.parameters,docs:{...m.parameters?.docs,source:{originalSource:`{
  render: () => {
    const root = document.createElement('div');
    root.id = ID;
    return root;
  },
  play: async (): Promise<void> => {
    await cleanGames();
    await nextFrames(3);
    createGame(ID, {
      type: Phaser.AUTO,
      width: 800,
      height: 600,
      backgroundColor: Color.rgb('slate-900'),
      parent: document.getElementById(ID) as HTMLElement,
      scene: [PreviewScene]
    });
  }
}`,...m.parameters?.docs?.source}}};const N=["Default"];export{m as Default,N as __namedExportsOrder,L as default};
