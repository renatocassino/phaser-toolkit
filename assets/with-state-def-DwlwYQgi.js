import{c as q,g as En}from"./_commonjsHelpers-Cpj98o6Y.js";var P={exports:{}};P.exports;var jt;function yn(){return jt||(jt=1,(function(o,r){var a=200,s="__lodash_hash_undefined__",c=800,u=16,b=9007199254740991,_="[object Arguments]",v="[object Array]",w="[object AsyncFunction]",Nt="[object Boolean]",Lt="[object Date]",zt="[object Error]",st="[object Function]",Pt="[object GeneratorFunction]",Gt="[object Map]",Mt="[object Number]",Ut="[object Null]",ct="[object Object]",Ft="[object Proxy]",Ht="[object RegExp]",Kt="[object Set]",Vt="[object String]",Bt="[object Undefined]",qt="[object WeakMap]",Wt="[object ArrayBuffer]",Zt="[object DataView]",Jt="[object Float32Array]",Xt="[object Float64Array]",Yt="[object Int8Array]",Qt="[object Int16Array]",kt="[object Int32Array]",te="[object Uint8Array]",ee="[object Uint8ClampedArray]",ne="[object Uint16Array]",re="[object Uint32Array]",oe=/[\\^$.*+?()[\]{}|]/g,ie=/^\[object .+?Constructor\]$/,ae=/^(?:0|[1-9]\d*)$/,h={};h[Jt]=h[Xt]=h[Yt]=h[Qt]=h[kt]=h[te]=h[ee]=h[ne]=h[re]=!0,h[_]=h[v]=h[Wt]=h[Nt]=h[Zt]=h[Lt]=h[zt]=h[st]=h[Gt]=h[Mt]=h[ct]=h[Ht]=h[Kt]=h[Vt]=h[qt]=!1;var ft=typeof q=="object"&&q&&q.Object===Object&&q,se=typeof self=="object"&&self&&self.Object===Object&&self,j=ft||se||Function("return this")(),lt=r&&!r.nodeType&&r,R=lt&&!0&&o&&!o.nodeType&&o,ut=R&&R.exports===lt,W=ut&&ft.process,gt=(function(){try{var t=R&&R.require&&R.require("util").types;return t||W&&W.binding&&W.binding("util")}catch{}})(),ht=gt&&gt.isTypedArray;function ce(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function fe(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}function le(t){return function(e){return t(e)}}function ue(t,e){return t?.[e]}function ge(t,e){return function(n){return t(e(n))}}var he=Array.prototype,pe=Function.prototype,G=Object.prototype,Z=j["__core-js_shared__"],M=pe.toString,y=G.hasOwnProperty,pt=(function(){var t=/[^.]+$/.exec(Z&&Z.keys&&Z.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""})(),dt=G.toString,de=M.call(Object),_e=RegExp("^"+M.call(y).replace(oe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),U=ut?j.Buffer:void 0,_t=j.Symbol,vt=j.Uint8Array;U&&U.allocUnsafe;var bt=ge(Object.getPrototypeOf,Object),Tt=Object.create,ve=G.propertyIsEnumerable,be=he.splice,O=_t?_t.toStringTag:void 0,F=(function(){try{var t=Y(Object,"defineProperty");return t({},"",{}),t}catch{}})(),Te=U?U.isBuffer:void 0,mt=Math.max,me=Date.now,wt=Y(j,"Map"),N=Y(Object,"create"),we=(function(){function t(){}return function(e){if(!x(e))return{};if(Tt)return Tt(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}})();function I(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function Ee(){this.__data__=N?N(null):{},this.size=0}function ye(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}function Se(t){var e=this.__data__;if(N){var n=e[t];return n===s?void 0:n}return y.call(e,t)?e[t]:void 0}function Ae(t){var e=this.__data__;return N?e[t]!==void 0:y.call(e,t)}function Ce(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=N&&e===void 0?s:e,this}I.prototype.clear=Ee,I.prototype.delete=ye,I.prototype.get=Se,I.prototype.has=Ae,I.prototype.set=Ce;function E(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function Oe(){this.__data__=[],this.size=0}function Ie(t){var e=this.__data__,n=H(e,t);if(n<0)return!1;var i=e.length-1;return n==i?e.pop():be.call(e,n,1),--this.size,!0}function xe(t){var e=this.__data__,n=H(e,t);return n<0?void 0:e[n][1]}function $e(t){return H(this.__data__,t)>-1}function De(t,e){var n=this.__data__,i=H(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this}E.prototype.clear=Oe,E.prototype.delete=Ie,E.prototype.get=xe,E.prototype.has=$e,E.prototype.set=De;function $(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function je(){this.size=0,this.__data__={hash:new I,map:new(wt||E),string:new I}}function Re(t){var e=V(this,t).delete(t);return this.size-=e?1:0,e}function Ne(t){return V(this,t).get(t)}function Le(t){return V(this,t).has(t)}function ze(t,e){var n=V(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this}$.prototype.clear=je,$.prototype.delete=Re,$.prototype.get=Ne,$.prototype.has=Le,$.prototype.set=ze;function D(t){var e=this.__data__=new E(t);this.size=e.size}function Pe(){this.__data__=new E,this.size=0}function Ge(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}function Me(t){return this.__data__.get(t)}function Ue(t){return this.__data__.has(t)}function Fe(t,e){var n=this.__data__;if(n instanceof E){var i=n.__data__;if(!wt||i.length<a-1)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new $(i)}return n.set(t,e),this.size=n.size,this}D.prototype.clear=Pe,D.prototype.delete=Ge,D.prototype.get=Me,D.prototype.has=Ue,D.prototype.set=Fe;function He(t,e){var n=tt(t),i=!n&&k(t),f=!n&&!i&&Ct(t),g=!n&&!i&&!f&&It(t),p=n||i||f||g,l=p?fe(t.length,String):[],d=l.length;for(var m in t)p&&(m=="length"||f&&(m=="offset"||m=="parent")||g&&(m=="buffer"||m=="byteLength"||m=="byteOffset")||St(m,d))||l.push(m);return l}function J(t,e,n){(n!==void 0&&!B(t[e],n)||n===void 0&&!(e in t))&&X(t,e,n)}function Ke(t,e,n){var i=t[e];(!(y.call(t,e)&&B(i,n))||n===void 0&&!(e in t))&&X(t,e,n)}function H(t,e){for(var n=t.length;n--;)if(B(t[n][0],e))return n;return-1}function X(t,e,n){e=="__proto__"&&F?F(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}var Ve=rn();function K(t){return t==null?t===void 0?Bt:Ut:O&&O in Object(t)?on(t):un(t)}function Et(t){return L(t)&&K(t)==_}function Be(t){if(!x(t)||fn(t))return!1;var e=nt(t)?_e:ie;return e.test(dn(t))}function qe(t){return L(t)&&Ot(t.length)&&!!h[K(t)]}function We(t){if(!x(t))return ln(t);var e=At(t),n=[];for(var i in t)i=="constructor"&&(e||!y.call(t,i))||n.push(i);return n}function yt(t,e,n,i,f){t!==e&&Ve(e,function(g,p){if(f||(f=new D),x(g))Ze(t,e,p,n,yt,i,f);else{var l=i?i(Q(t,p),g,p+"",t,e,f):void 0;l===void 0&&(l=g),J(t,p,l)}},xt)}function Ze(t,e,n,i,f,g,p){var l=Q(t,n),d=Q(e,n),m=p.get(d);if(m){J(t,n,m);return}var T=g?g(l,d,n+"",t,e,p):void 0,z=T===void 0;if(z){var rt=tt(d),ot=!rt&&Ct(d),Dt=!rt&&!ot&&It(d);T=d,rt||ot||Dt?tt(l)?T=l:_n(l)?T=tn(l):ot?(z=!1,T=Ye(d)):Dt?(z=!1,T=ke(d)):T=[]:vn(d)||k(d)?(T=l,k(l)?T=bn(l):(!x(l)||nt(l))&&(T=an(d))):z=!1}z&&(p.set(d,T),f(T,d,i,g,p),p.delete(d)),J(t,n,T)}function Je(t,e){return hn(gn(t,e,$t),t+"")}var Xe=F?function(t,e){return F(t,"toString",{configurable:!0,enumerable:!1,value:mn(e),writable:!0})}:$t;function Ye(t,e){return t.slice()}function Qe(t){var e=new t.constructor(t.byteLength);return new vt(e).set(new vt(t)),e}function ke(t,e){var n=Qe(t.buffer);return new t.constructor(n,t.byteOffset,t.length)}function tn(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e}function en(t,e,n,i){var f=!n;n||(n={});for(var g=-1,p=e.length;++g<p;){var l=e[g],d=void 0;d===void 0&&(d=t[l]),f?X(n,l,d):Ke(n,l,d)}return n}function nn(t){return Je(function(e,n){var i=-1,f=n.length,g=f>1?n[f-1]:void 0,p=f>2?n[2]:void 0;for(g=t.length>3&&typeof g=="function"?(f--,g):void 0,p&&sn(n[0],n[1],p)&&(g=f<3?void 0:g,f=1),e=Object(e);++i<f;){var l=n[i];l&&t(e,l,i,g)}return e})}function rn(t){return function(e,n,i){for(var f=-1,g=Object(e),p=i(e),l=p.length;l--;){var d=p[++f];if(n(g[d],d,g)===!1)break}return e}}function V(t,e){var n=t.__data__;return cn(e)?n[typeof e=="string"?"string":"hash"]:n.map}function Y(t,e){var n=ue(t,e);return Be(n)?n:void 0}function on(t){var e=y.call(t,O),n=t[O];try{t[O]=void 0;var i=!0}catch{}var f=dt.call(t);return i&&(e?t[O]=n:delete t[O]),f}function an(t){return typeof t.constructor=="function"&&!At(t)?we(bt(t)):{}}function St(t,e){var n=typeof t;return e=e??b,!!e&&(n=="number"||n!="symbol"&&ae.test(t))&&t>-1&&t%1==0&&t<e}function sn(t,e,n){if(!x(n))return!1;var i=typeof e;return(i=="number"?et(n)&&St(e,n.length):i=="string"&&e in n)?B(n[e],t):!1}function cn(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function fn(t){return!!pt&&pt in t}function At(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||G;return t===n}function ln(t){var e=[];if(t!=null)for(var n in Object(t))e.push(n);return e}function un(t){return dt.call(t)}function gn(t,e,n){return e=mt(e===void 0?t.length-1:e,0),function(){for(var i=arguments,f=-1,g=mt(i.length-e,0),p=Array(g);++f<g;)p[f]=i[e+f];f=-1;for(var l=Array(e+1);++f<e;)l[f]=i[f];return l[e]=n(p),ce(t,this,l)}}function Q(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}var hn=pn(Xe);function pn(t){var e=0,n=0;return function(){var i=me(),f=u-(i-n);if(n=i,f>0){if(++e>=c)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function dn(t){if(t!=null){try{return M.call(t)}catch{}try{return t+""}catch{}}return""}function B(t,e){return t===e||t!==t&&e!==e}var k=Et((function(){return arguments})())?Et:function(t){return L(t)&&y.call(t,"callee")&&!ve.call(t,"callee")},tt=Array.isArray;function et(t){return t!=null&&Ot(t.length)&&!nt(t)}function _n(t){return L(t)&&et(t)}var Ct=Te||wn;function nt(t){if(!x(t))return!1;var e=K(t);return e==st||e==Pt||e==w||e==Ft}function Ot(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=b}function x(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}function L(t){return t!=null&&typeof t=="object"}function vn(t){if(!L(t)||K(t)!=ct)return!1;var e=bt(t);if(e===null)return!0;var n=y.call(e,"constructor")&&e.constructor;return typeof n=="function"&&n instanceof n&&M.call(n)==de}var It=ht?le(ht):qe;function bn(t){return en(t,xt(t))}function xt(t){return et(t)?He(t):We(t)}var Tn=nn(function(t,e,n){yt(t,e,n)});function mn(t){return function(){return t}}function $t(t){return t}function wn(){return!1}o.exports=Tn})(P,P.exports)),P.exports}var Sn=yn();const An=En(Sn),S=()=>new Date().toISOString().replace("T"," ").replace("Z",""),A=o=>{const r=S(),a="%c[phaser-hooks]%c",s=o?` %c${o}%c`:"";return`%c[${r}]%c ${a}${s}`},C=o=>{const r=["color: #bd93f9; font-weight: bold;","color: inherit;","color: #2563eb; font-weight: bold;","color: inherit;"];return o&&r.push("color: #059669; font-weight: bold;","color: inherit;"),r},Cn=(o,r)=>{const a=A("STATE_INIT"),s=C("STATE_INIT");console.groupCollapsed(`${a} Initializing state "${o}"`,...s),console.log("🔧 Key:",o),console.log("📦 Initial Value:",r),console.log("⏰ Timestamp:",S()),console.groupEnd()},On=(o,r)=>{const a=A("STATE_GET"),s=C("STATE_GET");console.log(`${a} Getting state "${o}":`,...s,r)},it=(o,r,a)=>{const s=A("STATE_SET"),c=C("STATE_SET");console.groupCollapsed(`${s} Updating state "${o}"`,...c),console.log("🔑 Key:",o),console.log("📤 Old Value:",r),console.log("📥 New Value:",a),console.log("🔄 Changed:",r!==a),console.log("⏰ Timestamp:",S()),console.groupEnd()},Rt=(o,r,a)=>{const s=A("EVENT_ADD"),c=C("EVENT_ADD");console.groupCollapsed(`${s} Adding listener for "${o}"`,...c),console.log("🔑 Key:",o),console.log("📡 Event:",r),console.log("🎯 Callback:",a.name||"anonymous"),console.log("⏰ Timestamp:",S()),console.groupEnd()},at=(o,r,a)=>{const s=A("EVENT_REMOVE"),c=C("EVENT_REMOVE");console.groupCollapsed(`${s} Removing listener for "${o}"`,...c),console.log("🔑 Key:",o),console.log("📡 Event:",r),console.log("🎯 Callback:",a.name||"anonymous"),console.log("⏰ Timestamp:",S()),console.groupEnd()},In=o=>{const r=A("CLEAR_LISTENERS"),a=C("CLEAR_LISTENERS");console.groupCollapsed(`${r} Clearing all listeners for "${o}"`,...a),console.log("🔑 Key:",o),console.log("🧹 Action:","Removing all event listeners"),console.log("⏰ Timestamp:",S()),console.groupEnd()},xn=(o,r,a)=>{const s=A(o),c=C(o);console.groupCollapsed(`${s} ERROR`,...c),console.error("🚨 Operation:",o),console.error("💥 Error:",r),a&&console.error("📋 Context:",a),console.error("⏰ Timestamp:",S()),console.groupEnd()},$n=(o,r,a)=>{const s=A(o),c=C(o);console.groupCollapsed(`${s} WARNING`,...c),console.warn("⚠️ Operation:",o),console.warn("📢 Message:",r),a&&console.warn("📋 Context:",a),console.warn("⏰ Timestamp:",S()),console.groupEnd()},Dn=(o,r,a)=>{const s=o.get(r);return a&&On(r,s),s},jn=(o,r,a,s,c)=>{const u=o.get(r),b=typeof a=="function"?a(u):a;if(c){const _=c(b);if(_!==!0){const v=typeof _=="string"?_:`Invalid value for key "${r}"`;throw new Error(`[withStateDef] ${v}`)}}o.set(r,b),s&&it(r,u,b)},Rn=(o,r,a,s,c)=>{const u=o.get(r);if(typeof u!="object"||u===null)throw new Error("[withStateDef] Current value is not an object");const b=typeof a=="function"?a(u):a,_=An({},u,b);if(c){const v=c(_);if(v!==!0){const w=typeof v=="string"?v:`Invalid value for key "${r}"`;throw new Error(`[withStateDef] ${w}`)}}o.set(r,_),s&&it(r,u,_)},Nn=(o,r,a,s)=>{if($n("DEPRECATED_ONCHANGE","onChange callback is deprecated in phaser-hooks. Use .on('change', callback) or .once('change', callback) instead.",{key:r}),!s||typeof s!="function")throw new Error("[withStateDef] onChange callback must be a function");o.events.on(`changedata-${r}`,(c,u,b,_)=>{a&&it(u,_,b);try{s(b,_)}catch(v){xn("ONCHANGE_CALLBACK_ERROR",v,{key:u})}})},Ln=(o,r,a,s,c)=>{if(r!=="change")throw new Error('[withStateDef] Invalid event. Only "change" is supported.');return s&&Rt(a,r,c),o.events.on(`changedata-${a}`,c),()=>{s&&at(a,r,c),o.events.off(`changedata-${a}`,c)}},zn=(o,r,a)=>{if(!o)throw new Error("[withStateDef] Scene parameter is required");if(!a||typeof a!="string"||a.trim().length===0)throw new Error("[withStateDef] Key must be a non-empty string");if(r.global&&!o.registry)throw new Error("[withStateDef] Scene registry is not available. Ensure the scene is properly initialized.");if(!r.global&&!o.data)throw new Error("[withStateDef] Scene data is not available. Ensure the scene is properly initialized.")},Pn=(o,r,a,s,c)=>{if(!o.has(r)&&c!==void 0){if(s){const u=s(c);if(u!==!0){const b=typeof u=="string"?u:`Invalid initial value for key "${r}"`;throw new Error(`[withStateDef] ${b}`)}}o.set(r,c),a&&Cn(r,c)}},Gn=(o,r,a,s,c)=>{if(r!=="change")throw new Error('[withStateDef] Invalid event. Only "change" is supported.');return s&&Rt(a,r,c),o.events.once(`changedata-${a}`,c),()=>{s&&at(a,r,c),o.events.off(`changedata-${a}`,c)}},Mn=(o,r,a,s,c)=>{if(r!=="change")throw new Error('[withStateDef] Invalid event. Only "change" is supported.');o.events.off(`changedata-${a}`,c),s&&at(a,r,c)},Un=(o,r,a)=>{o.events.removeAllListeners(`changedata-${r}`),a&&In(r)},Hn=(o,r,a,s={})=>{zn(o,s,r);const{validator:c,debug:u=!1,global:b=!1}=s,_=b?o.registry:o.data;return Pn(_,r,u,c,a),{get:()=>Dn(_,r,u),set:v=>jn(_,r,v,u,c),patch:v=>Rn(_,r,v,u,c),onChange:v=>Nn(_,r,u,v),on:(v,w)=>Ln(_,v,r,u,w),once:(v,w)=>Gn(_,v,r,u,w),off:(v,w)=>Mn(_,v,r,u,w),clearListeners:()=>Un(_,r,u)}};export{Hn as w};
