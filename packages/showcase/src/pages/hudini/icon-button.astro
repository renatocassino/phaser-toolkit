---
import Layout from '../../layouts/Layout.astro';
import PhaserGame from '../../components/PhaserGame.astro';
---

<Layout title="Hudini Icon Button Component" description="An interactive circular icon button with hover and click animations, built on top of phaser-wind and font-awesome-for-phaser.">
  <div class="space-y-8">
    <!-- Description -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
      <h2 class="text-xl font-semibold text-gray-900 mb-4">Icon Button Component</h2>
      <p class="text-gray-600 mb-4">
        An interactive circular icon button with hover and click animations, built on top of phaser-wind and font-awesome-for-phaser.
      </p>

      <!-- Features -->
      <div class="mb-6">
        <h3 class="text-lg font-semibold text-gray-900 mb-3">Features</h3>
        <ul class="list-disc list-inside space-y-1 text-gray-600">
          <li>üñ±Ô∏è <strong>Interactive</strong>: Hover scales the icon subtly, click animates press/release</li>
          <li>üé® <strong>Customizable</strong>: Colors and sizes integrate with phaser-wind theme tokens</li>
          <li>üéØ <strong>Font Awesome Icons</strong>: Uses any icon from font-awesome-for-phaser</li>
          <li>üåë <strong>Shadow Effects</strong>: Beautiful shadow effects for depth</li>
          <li>‚ö° <strong>Performance</strong>: Optimized animations for smooth 60fps gameplay</li>
          <li>üîó <strong>Event API</strong>: Direct access to interactive methods for advanced event handling</li>
        </ul>
      </div>

      <!-- Props -->
      <div class="mb-6">
        <h3 class="text-lg font-semibold text-gray-900 mb-3">Props</h3>
        <div class="bg-gray-50 rounded-lg p-4">
          <ul class="space-y-2 text-sm">
            <li><code class="bg-gray-200 px-2 py-1 rounded">icon</code> - IconKey from font-awesome-for-phaser (e.g., 'heart', 'user', 'play')</li>
            <li><code class="bg-gray-200 px-2 py-1 rounded">size</code> - Font size token ('xs', 'sm', 'base', 'lg', 'xl'...) or pixel value - default: 'base'</li>
            <li><code class="bg-gray-200 px-2 py-1 rounded">color</code> - Base color from phaser-wind (except black/white) - default: 'gray'</li>
            <li><code class="bg-gray-200 px-2 py-1 rounded">onClick</code> - Optional click handler function</li>
            <li><code class="bg-gray-200 px-2 py-1 rounded">borderRadius</code> - Border radius token ('none', 'sm', 'md', 'lg', 'xl', 'full') or pixel value - default: 'full'</li>
          </ul>
        </div>
      </div>

      <!-- Methods -->
      <div class="mb-6">
        <h3 class="text-lg font-semibold text-gray-900 mb-3">Methods</h3>
        <div class="bg-gray-50 rounded-lg p-4">
          <ul class="space-y-2 text-sm">
            <li><code class="bg-gray-200 px-2 py-1 rounded">setButtonSize(size)</code> - Change button size</li>
            <li><code class="bg-gray-200 px-2 py-1 rounded">setBorderRadius(radius)</code> - Change border radius</li>
            <li><code class="bg-gray-200 px-2 py-1 rounded">interactive</code> - Access to Phaser interactive methods (on, off, once, setInteractive)</li>
            <li><code class="bg-gray-200 px-2 py-1 rounded">getBounds()</code> - Get button bounds for layout calculations</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Live Example -->
    <PhaserGame width={800} height={700} />

    <!-- Usage Example -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
      <h3 class="text-lg font-semibold text-gray-900 mb-3">Usage Example</h3>
      <div class="bg-gray-900 rounded-lg p-4 overflow-x-auto">
        <pre class="text-sm text-gray-100"><code>{`import Phaser from 'phaser';
import {
    Color,
    createTheme,
    HUDINI_KEY,
    HudiniPlugin,
    SceneWithHudini,
    IconButton
} from 'hudini';

const theme = createTheme({});
type Theme = typeof theme;

class ButtonDemoScene extends SceneWithHudini<Theme> {
    constructor() {
        super('button-demo');
    }

    create(): void {
        const { pw } = this.hudini;
        this.cameras.main.setBackgroundColor(pw.color.slate(900));

        // Create a heart icon button
        const heartButton = new IconButton({
            scene: this,
            x: this.cameras.main.centerX,
            y: 200,
            icon: 'heart',
            size: 'lg',
            color: 'red',
            onClick: () => {
                console.log('Heart clicked!');
            },
        });
        this.add.existing(heartButton);

        // Create a play icon button
        const playButton = new IconButton({
            scene: this,
            x: this.cameras.main.centerX - 100,
            y: 300,
            icon: 'play',
            size: 'xl',
            color: 'green',
            onClick: () => {
                console.log('Play clicked!');
            },
        });
        this.add.existing(playButton);
    }
}`}</code></pre>
      </div>
    </div>

    <!-- Advanced Examples -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
      <h3 class="text-lg font-semibold text-gray-900 mb-3">Advanced Examples</h3>
      
      <div class="space-y-4">
        <div>
          <h4 class="font-medium text-gray-900 mb-2">Using Interactive API</h4>
          <div class="bg-gray-900 rounded-lg p-4 overflow-x-auto">
            <pre class="text-sm text-gray-100"><code>{`const button = new IconButton({ 
    scene: this, 
    x: 100, 
    y: 100, 
    icon: 'play',
    onClick: () => console.log('Basic click')
});

// Access interactive methods directly
button.interactive.on('pointerover', () => console.log('Hover'));
button.interactive.on('pointerdown', () => console.log('Press'));
button.interactive.once('pointerup', () => console.log('Release once'));`}</code></pre>
          </div>
        </div>

        <div>
          <h4 class="font-medium text-gray-900 mb-2">Different Border Radius</h4>
          <div class="bg-gray-900 rounded-lg p-4 overflow-x-auto">
            <pre class="text-sm text-gray-100"><code>{`// Circular button (default)
const circularBtn = new IconButton({
    scene: this,
    x: 200,
    y: 200,
    icon: 'solid/star',
    borderRadius: 'full',
});

// Rounded square button
const roundedBtn = new IconButton({
    scene: this,
    x: 300,
    y: 200,
    icon: 'solid/heart',
    borderRadius: 'lg',
});`}</code></pre>
          </div>
        </div>

        <div>
          <h4 class="font-medium text-gray-900 mb-2">Dynamic Updates</h4>
          <div class="bg-gray-900 rounded-lg p-4 overflow-x-auto">
            <pre class="text-sm text-gray-100"><code>{`const button = new IconButton({
    scene: this,
    x: 400,
    y: 300,
    icon: 'gear',
    size: 'base',
});

// Update size dynamically
button.setButtonSize('xl');

// Update border radius
button.setBorderRadius('lg');`}</code></pre>
          </div>
        </div>
      </div>
    </div>
  </div>
</Layout>

<script>
  import Phaser from 'phaser';
  import {
    createTheme,
    HUDINI_KEY,
    HudiniPlugin,
    SceneWithHudini,
    IconButton,
  } from 'hudini';
import { type IconKey, loadFont } from 'font-awesome-for-phaser';
import { type ColorKey, type ColorToken, type FontSizeKey } from 'phaser-wind';

  // Create theme
  const theme = createTheme({});
  type Theme = typeof theme;

  class IconButtonDemoScene extends SceneWithHudini<Theme> {
    private buttons: IconButton[] = [];
    private clickCount = 0;
    private clickText?: Phaser.GameObjects.Text;

    constructor() {
      super('icon-button-demo');
    }

    create(): void {
      const { pw } = this.hudini;
      this.cameras.main.setBackgroundColor(pw.color.white());

      // Title
      this.add.text(this.cameras.main.centerX, 40, 'Icon Button Examples', {
        color: pw.color.slate(200),
        align: 'center',
        fontSize: '32px',
        fontStyle: 'bold',
      }).setOrigin(0.5, 0.5);

      // Click counter text
      this.clickText = this.add.text(this.cameras.main.centerX, 80, 'Clicks: 0', {
        color: pw.color.slate(400),
        align: 'center',
        fontSize: '16px',
      }).setOrigin(0.5, 0.5);

      // Example 1: Heart (red)
      const heartButton = new IconButton({
        scene: this,
        x: this.cameras.main.centerX - 240,
        y: 150,
        icon: 'heart',
        size: 'lg',
        color: 'red-500',
        onClick: () => {
          this.clickCount++;
          if (this.clickText) {
            this.clickText.setText(`Clicks: ${this.clickCount}`);
          }
        },
      });
      this.add.existing(heartButton);
      this.buttons.push(heartButton);

      // Example 2: Star (yellow)
      const starButton = new IconButton({
        scene: this,
        x: this.cameras.main.centerX - 120,
        y: 150,
        icon: 'star',
        size: 'lg',
        color: 'yellow-500',
        onClick: () => {
          this.clickCount++;
          if (this.clickText) {
            this.clickText.setText(`Clicks: ${this.clickCount}`);
          }
        },
      });
      this.add.existing(starButton);
      this.buttons.push(starButton);

      // Example 3: Play (green)
      const playButton = new IconButton({
        scene: this,
        x: this.cameras.main.centerX,
        y: 150,
        icon: 'play',
        size: 'lg',
        color: 'green-500',
        onClick: () => {
          this.clickCount++;
          if (this.clickText) {
            this.clickText.setText(`Clicks: ${this.clickCount}`);
          }
        },
      });
      this.add.existing(playButton);
      this.buttons.push(playButton);

      // Example 4: Pause (blue)
      const pauseButton = new IconButton({
        scene: this,
        x: this.cameras.main.centerX + 120,
        y: 150,
        icon: 'pause',
        size: 'lg',
        color: 'blue-500',
        onClick: () => {
          this.clickCount++;
          if (this.clickText) {
            this.clickText.setText(`Clicks: ${this.clickCount}`);
          }
        },
      });
      this.add.existing(pauseButton);
      this.buttons.push(pauseButton);

      // Example 5: Gear (gray)
      const gearButton = new IconButton({
        scene: this,
        x: this.cameras.main.centerX + 240,
        y: 150,
        icon: 'gear',
        size: 'lg',
        color: 'gray-500',
        onClick: () => {
          this.clickCount++;
          if (this.clickText) {
            this.clickText.setText(`Clicks: ${this.clickCount}`);
          }
        },
      });
      this.add.existing(gearButton);
      this.buttons.push(gearButton);

      // Example 6: Trash (red, smaller)
      const trashButton = new IconButton({
        scene: this,
        x: this.cameras.main.centerX - 180,
        y: 280,
        icon: 'trash',
        size: 'base',
        color: 'red-500',
        onClick: () => {
          this.clickCount++;
          if (this.clickText) {
            this.clickText.setText(`Clicks: ${this.clickCount}`);
          }
        },
      });
      this.add.existing(trashButton);
      this.buttons.push(trashButton);

      // Example 7: User (purple)
      const userButton = new IconButton({
        scene: this,
        x: this.cameras.main.centerX - 60,
        y: 280,
        icon: 'user',
        size: 'base',
        color: 'purple-500',
        onClick: () => {
          this.clickCount++;
          if (this.clickText) {
            this.clickText.setText(`Clicks: ${this.clickCount}`);
          }
        },
      });
      this.add.existing(userButton);
      this.buttons.push(userButton);

      // Example 8: Home (indigo)
      const homeButton = new IconButton({
        scene: this,
        x: this.cameras.main.centerX + 60,
        y: 280,
        icon: 'house',
        size: 'base',
        color: 'indigo-500',
        onClick: () => {
          this.clickCount++;
          if (this.clickText) {
            this.clickText.setText(`Clicks: ${this.clickCount}`);
          }
        },
      });
      this.add.existing(homeButton);
      this.buttons.push(homeButton);

      // Example 9: Envelope (cyan)
      const envelopeButton = new IconButton({
        scene: this,
        x: this.cameras.main.centerX + 180,
        y: 280,
        icon: 'envelope',
        size: 'base',
        color: 'cyan-500',
        onClick: () => {
          this.clickCount++;
          if (this.clickText) {
            this.clickText.setText(`Clicks: ${this.clickCount}`);
          }
        },
      });
      this.add.existing(envelopeButton);
      this.buttons.push(envelopeButton);

      // Example 10: Different sizes row
      const sizes: { size: FontSizeKey | number, icon: IconKey, color: ColorToken, x: number }[] = [
        { size: 'sm' as const, icon: 'circle', color: 'blue-500' as const, x: this.cameras.main.centerX - 180 },
        { size: 'base' as const, icon: 'square', color: 'green-500' as const, x: this.cameras.main.centerX - 60 },
        { size: 'lg' as const, icon: 'diamond', color: 'purple-300' as const, x: this.cameras.main.centerX + 60 },
        { size: 'xl' as const, icon: 'triangle-exclamation', color: 'emerald-700' as const, x: this.cameras.main.centerX + 180 },
      ];

      sizes.forEach((config, index) => {
        const sizeButton = new IconButton({
          scene: this,
          x: config.x,
          y: 410,
          icon: config.icon as IconKey,
          size: config.size as FontSizeKey,
          color: config.color,
          onClick: () => {
            this.clickCount++;
            if (this.clickText) {
              this.clickText.setText(`Clicks: ${this.clickCount}`);
            }
          },
        });
        this.add.existing(sizeButton);
        this.buttons.push(sizeButton);
      });

      // Example 11: Different border radius
      const roundedButton = new IconButton({
        scene: this,
        x: this.cameras.main.centerX - 120,
        y: 540,
        icon: 'check',
        size: 'lg',
        color: 'green-600',
        borderRadius: 'lg',
        onClick: () => {
          this.clickCount++;
          if (this.clickText) {
            this.clickText.setText(`Clicks: ${this.clickCount}`);
          }
        },
      });
      this.add.existing(roundedButton);
      this.buttons.push(roundedButton);

      const squareButton = new IconButton({
        scene: this,
        x: this.cameras.main.centerX + 120,
        y: 540,
        icon: 'xmark',
        size: 'lg',
        color: 'red-600',
        borderRadius: 'md',
        onClick: () => {
          this.clickCount++;
          if (this.clickText) {
            this.clickText.setText(`Clicks: ${this.clickCount}`);
          }
        },
      });
      this.add.existing(squareButton);
      this.buttons.push(squareButton);

      // Add labels
      this.add.text(this.cameras.main.centerX - 240, 200, 'Heart', {
        color: pw.color.slate(400),
        align: 'center',
        fontSize: '12px',
      }).setOrigin(0.5, 0.5);

      this.add.text(this.cameras.main.centerX - 120, 200, 'Star', {
        color: pw.color.slate(400),
        align: 'center',
        fontSize: '12px',
      }).setOrigin(0.5, 0.5);

      this.add.text(this.cameras.main.centerX, 200, 'Play', {
        color: pw.color.slate(400),
        align: 'center',
        fontSize: '12px',
      }).setOrigin(0.5, 0.5);

      this.add.text(this.cameras.main.centerX + 120, 200, 'Pause', {
        color: pw.color.slate(400),
        align: 'center',
        fontSize: '12px',
      }).setOrigin(0.5, 0.5);

      this.add.text(this.cameras.main.centerX + 240, 200, 'Gear', {
        color: pw.color.slate(400),
        align: 'center',
        fontSize: '12px',
      }).setOrigin(0.5, 0.5);

      this.add.text(this.cameras.main.centerX - 180, 330, 'Trash', {
        color: pw.color.slate(400),
        align: 'center',
        fontSize: '12px',
      }).setOrigin(0.5, 0.5);

      this.add.text(this.cameras.main.centerX - 60, 330, 'User', {
        color: pw.color.slate(400),
        align: 'center',
        fontSize: '12px',
      }).setOrigin(0.5, 0.5);

      this.add.text(this.cameras.main.centerX + 60, 330, 'Home', {
        color: pw.color.slate(400),
        align: 'center',
        fontSize: '12px',
      }).setOrigin(0.5, 0.5);

      this.add.text(this.cameras.main.centerX + 180, 330, 'Mail', {
        color: pw.color.slate(400),
        align: 'center',
        fontSize: '12px',
      }).setOrigin(0.5, 0.5);

      this.add.text(this.cameras.main.centerX, 460, 'Different Sizes', {
        color: pw.color.slate(400),
        align: 'center',
        fontSize: '12px',
      }).setOrigin(0.5, 0.5);

      this.add.text(this.cameras.main.centerX - 120, 590, 'Rounded', {
        color: pw.color.slate(400),
        align: 'center',
        fontSize: '12px',
      }).setOrigin(0.5, 0.5);

      this.add.text(this.cameras.main.centerX + 120, 590, 'Square', {
        color: pw.color.slate(400),
        align: 'center',
        fontSize: '12px',
      }).setOrigin(0.5, 0.5);

      // Add instructions
      this.add.text(this.cameras.main.centerX, 640, 'Hover and click the buttons to see interactions', {
        color: pw.color.slate(400),
        align: 'center',
        fontSize: '14px',
      }).setOrigin(0.5, 0.5);
    }
  }

  // Initialize the game when the page loads
  document.addEventListener('DOMContentLoaded', () => {
    const gameConfig = (window as any).gameContainer;
    loadFont().then(() => {
      if (gameConfig) {
        const game = new Phaser.Game({
          ...gameConfig,
          scene: [IconButtonDemoScene],
          plugins: {
            global: [
              {
                key: HUDINI_KEY,
                plugin: HudiniPlugin,
                mapping: HUDINI_KEY,
                data: {
                  theme,
                },
              },
            ],
          },
        });
        
        // Store the game instance
        if (!(window as any).__phaserGames) {
          (window as any).__phaserGames = {};
        }
        (window as any).__phaserGames['hudini-icon-button-demo'] = game;
      }
    });
  });
</script>
